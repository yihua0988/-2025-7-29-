$(document).ready(function () {//https轉導
    //if (location.protocol != 'https:') {
    //    var url = window.location.href;
    //    if (url.indexOf("archive2.businessweekly.com.tw") != -1) {
    //        location.href = 'https:' + window.location.href.substring(window.location.protocol.length).replace("archive2.businessweekly.com.tw/", "www.businessweekly.com.tw/Archive/");
    //    }
    //    else {
    //        location.href = 'https:' + window.location.href.substring(window.location.protocol.length);
    //    }
    //}
    //else {
    //    var url = window.location.href;
    //    if (url.indexOf("archive2.businessweekly.com.tw") != -1) {
    //        location.href = window.location.href.replace("archive2.businessweekly.com.tw/", "www.businessweekly.com.tw/Archive/");
    //    }
    //}
});

//Alert視窗
function ChangeAlertWord(data) {
    document.getElementById("textelement").innerHTML = unescape(escape(data.toString()));
    $('#myModal').modal('show');
}

function Alert(data) {
    document.getElementById("textelement").innerHTML = unescape(escape(data.toString()));
    $('#myModal').modal('show');
    $("#myModal").addClass("in");
}
function Return(data, url) {
    document.getElementById("textelement").innerHTML = unescape(escape(data.toString()));
    $('#myModal').modal('show')
        .on('click', '#modal_Close', function (e) {
            window.location = url;
        });
    $("#myModal").addClass("in");
}
function Alert2(data) {
    document.getElementById("textelement2").innerHTML = unescape(escape(data.toString()));
    $('#myModal3').modal('show');
    $("#myModal3").addClass("in");
}
function Return2(data, url) {
    document.getElementById("textelement2").innerHTML = unescape(escape(data.toString()));
    $('#myModal3').modal('show')
        .on('click', '#modal_Close', function (e) {
            window.location = url;
        });
    $("#myModal").addClass("in");
}

//#region cookies操作

function SetCookie(name, value) {//網域版
    var Days = 15; //15 天
    var dt, expires;
    dt = new Date();
    dt.setTime(dt.getTime() + (Days * 24 * 60 * 60 * 1000));
    expires = "; expires=" + dt.toGMTString();
    document.cookie = name + "=" + value + expires
        + '; domain=.businessweekly.com.tw;path=/'
}
function SetCookie2(name, value, Days) {//網域版

    var dt, expires;
    dt = new Date();
    dt.setTime(dt.getTime() + (Days * 24 * 60 * 60 * 1000));
    expires = "; expires=" + dt.toGMTString();
    document.cookie = name + "=" + value + expires
        + '; domain=.businessweekly.com.tw;path=/'
}
//function SetCookie(name, value) {//本機版
//    var Days = 15; //15 天
//    var exp = new Date();
//    exp.setTime(exp.getTime() + Days * 24 * 60 * 60 * 1000);
//    document.cookie = name + "=" + value + ";expires=" + exp.toGMTString();
//}

function getCookie(name)//取cookies
{
    var arr = document.cookie.match(new RegExp("(^| )" + name + "=([^;]*)(;|$)"));
    if (arr != null) return unescape(arr[2]); return null;

}

function delCookie(name)//删除cookie
{
    var exp = new Date();
    exp.setTime(exp.getTime() - 1);
    var cval = getCookie(name);
    if (cval != null) document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString();
}

function delDomainCookie(name)//删除網域cookie
{
    var exp = new Date();
    exp.setTime(exp.getTime() - 10);
    var cval = getCookie(name);
    if (cval != null) document.cookie = name + "=" + cval + ";expires=" + exp.toGMTString() + '; domain=.businessweekly.com.tw;path=/';
}

//#endregion

//取得目標字形大小
function GetFontSize(TargetId, PropertyName) {
    var xxfontSize = 0;
    if (document.getElementById(TargetId) != null) {
        var el = document.getElementById(TargetId);
        var style = window.getComputedStyle(el, null).getPropertyValue(PropertyName);
        xxfontSize = parseFloat(style);
    }
    return xxfontSize
}

//Return_Top_Of_Page
function ReturnTopOfPage() {
    $('html, body').animate({ scrollTop: 0 }, 'fast');
}

//動態新增class
function SetImgsClassByIdClass(selector, className) {
    $(selector + ' img').each(function () {
        if (this.naturalHeight > this.naturalWidth) {
            $(this).closest(selector).addClass(className);
        }
    });
}

//取得Scroll位置
function getScrollXY() {
    var x = 0, y = 0;
    if (typeof (window.pageYOffset) == 'number') {
        // Netscape
        x = window.pageXOffset;
        y = window.pageYOffset;
    } else if (document.body && (document.body.scrollLeft || document.body.scrollTop)) {
        // DOM
        x = document.body.scrollLeft;
        y = document.body.scrollTop;
    } else if (document.documentElement && (document.documentElement.scrollLeft || document.documentElement.scrollTop)) {
        // IE6 standards compliant mode
        x = document.documentElement.scrollLeft;
        y = document.documentElement.scrollTop;
    }
    return [x, y];
}

//設定物件位置
function placeDiv(DivId, x_pos, y_pos) {
    var d = document.getElementById(DivId);
    d.style.position = "absolute";
    d.style.left = x_pos + 'px';
    d.style.top = y_pos + 'px';
}

//移除DropdownList全部下拉內容
function removeOptions(selectbox) {
    var i;
    for (i = selectbox.options.length - 1; i >= 0; i--) {
        selectbox.remove(i);
    }
}

//清除全部cookie
function DelAllCookies() {
    var cookies = document.cookie.split(";");

    for (var i = 0; i < cookies.length; i++) {
        var cookie = cookies[i];
        var eqPos = cookie.indexOf("=");
        var name = eqPos > -1 ? cookie.substr(0, eqPos) : cookie;
        document.cookie = name + "=;expires=Thu, 01 Jan 1970 00:00:00 GMT";
    }
}

function change_dis_byclass(className, IsShow) {
    var x = document.getElementsByClassName(className);
    var i;
    for (i = 0; i < x.length; i++) {
        if (IsShow == "y") {
            x[i].style.display = "";
        } else {
            x[i].style.display = "none";
        }
    }
}


function loadJS(file) {
    var jsElm = document.createElement("script");
    jsElm.type = "application/javascript";
    jsElm.src = file;
    document.body.appendChild(jsElm);
}

function get_domain_url() {
    var url = window.location.href
    var arr = url.split("/");
    var result = arr[0] + "//" + arr[2]
    return result;
}

//回頁面最上方
function wgo_top() {
    document.body.scrollTop = 0;
    document.documentElement.scrollTop = 0;
}

if (!Array.prototype.find) {
    Array.prototype.find = function (callback) {
        return callback && (this.filter(callback) || [])[0];
    };
}


function get_url_value(name, url) {
    if (!url) url = location.href;
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(url);
    return results == null ? null : results[1];
}

function ArticleNewLogOut() {
    delDomainCookie("BWG_C");
    delDomainCookie("MC_m");
    delDomainCookie("MC_s");
    var CT = getCookie("BWG_CC");
    if (CT.length != 0) {
        var xdata = {
            Token: CT,
            JData: ''
        };

        fetch("https://apis.businessweekly.com.tw/member/v1/User/LoginOut", {
            method: 'POST',
            body: JSON.stringify(xdata),
            headers: { 'Content-Type': 'application/json; charset=utf-8' }
        })
            .then(res => {
                return res.json();
            })
            .then(datas => {
                if (datas.errorCode == 0) {
                    window.location.reload();
                }
                else {
                    Return(datas.errorMsg, location.href);
                }

            });
    }
}
// Select the main list and add the class "hasSubmenu" in each LI that contains an UL
$('ul').each(function () {
    $this = $(this);
    $this.find("li").has("ul").addClass("hasSubmenu");
});
// Find the last li in each level
$('li:last-child').each(function () {
    $this = $(this);
    // Check if LI has children
    if ($this.children('ul').length === 0) {
        // Add border-left in every UL where the last LI has not children
        $this.closest('ul');
    } else {
        // Add border in child LI, except in the last one
        $this.closest('ul').children("li").not(":last");
        // Add the class "addBorderBefore" to create the pseudo-element :defore in the last li
        $this.closest('ul').children("li").last().children("a").addClass("addBorderBefore");
        // Add margin in the first level of the list
        //$this.closest('ul').css("margin-left","20px");
        // Add margin in other levels of the list
        $this.closest('ul').find("li").children("ul").css("margin-left", "-2px");
    };
});
// Add bold in li and levels above
/* $('.sideSortmenu ul li').each(function(){
  $this = $( this );
  $this.mouseenter(function(){
    $( this ).children("a").css({"color":"#000"});
  });
  $this.mouseleave(function(){
    $( this ).children("a").css({"color":"#666"});
  });
}); */
// Add button to expand and condense - Using FontAwesome
$('.sideSortmenu .nav-list li.hasSubmenu').each(function () {
    $this = $(this);
    $this.prepend("<a href='#'><i class='fa fa-minus-circle'></i><i style='display:none;' class='fa fa-plus-circle'></i></a>");
    $this.children("a").not(":last").removeClass().addClass("toogle");

    if ($(this).is(".submenu")) {
        $this.find(".toogle").html("<i style='display:none;' class='fa fa-minus-circle'></i><i class='fa fa-plus-circle'></i>");
    }
});

$('.sideSortmenu .nav-list li li').children("ul").toggle("hide");

// Actions to expand and consense
$('.sideSortmenu ul li.hasSubmenu a.toogle').click(function () {
    $this = $(this);
    $this.closest("li").children("ul").toggle("slow");
    $this.children("i").toggle();
    return false;
});
/*! For license information please see globalUtils.min.js.LICENSE.txt */
console.log("globalUtils1128"),function(){let e=document.createElement("script");e.type="text/javascript","staging.businessweekly.com.tw"===window.location.hostname||window.location.href,e.src="https://member.businessweekly.com.tw/Content/js/Base.js?v=20240806",document.head.appendChild(e),console.log("Base.js appended")}(),window.user_id="",window.article_id="",window.app_key="",window.resource_id="",window.site_id="",window.resource_type="",window.server_id="",window.matchHostPathName=function(e){return e.test(window.location.hostname+window.location.pathname)},window.urlFindSearch=function(e){var t=window.location.search.match(new RegExp("(?:[\\?\\&]"+e+"=)([^&]+)"));return t?t[1]:null},window.loader=function(e,t="head"){return new Promise((function(n,o){var i=window.document.createElement("script");i.src=e,document[t].appendChild(i),i.addEventListener("load",(function(){n(i)}),!1),i.addEventListener("error",(function(){o(i)}),!1)}))},window.trackEvents=function(e,t,n,o,i=t,s=n,c=o){let w,a=document.querySelector("#gtm_id_list"),d=document.querySelector("#gtm_content_type");w=a&&d?`${d?d.value+"-":""}${a?a.value:n}`:n,window.TrackEvents&&(new TrackEvents).setEvents(e,t,w,o,null),window.gtag&&gtag("event",e,{event_category:i,event_label:s,value:c,non_interaction:!0})},window.loadBwExtScript=function(){let e=document.createElement("script");e.async=!0,"staging.businessweekly.com.tw"===window.location.hostname||"frontdev.businessweekly.com.tw"===window.location.hostname?e.src="https://frontdev.businessweekly.com.tw/test/gtm-test/bwGroupExtendMain.min.js":e.src="https://ibw.bwnet.com.tw/assets/library/bwg-ext/bwGroupExtendMain.min.js",document.body.appendChild(e)},window.addEventListener("DOMContentLoaded",loadBwExtScript),function(){const e=window.location.hostname,t=window.location.pathname;if(!(/^www\.businessweekly\.com\.tw$/i.test(e)||/^www3\.businessweekly\.com\.tw$/i.test(e)||/^staging\.businessweekly\.com\.tw$/i.test(e)))return;if("/Archive"===t||"/Archive/"===t||"/Archive3"===t||"/Archive3/"===t)return;const n=document.createElement("script");n.defer=!0,t.match(/\/Archive\/Article/)||t.match(/\/Archive3\/Article/)?n.src="https://admsapi.businessweekly.com.tw/ADMS.js":n.src="https://admsapi.businessweekly.com.tw/ADMS_Main_OptionalDelivery.js",document.head.appendChild(n)}();
function AjaxRecordPrinter(){window.print()}function AIndexReadArticle(){var n=getCookie("BWG_CC"),t;n.length!=0&&(t={Token:n,JData:{ArticleId:document.getElementById("ArticleIndex_id").value}},fetch(rut+"API/ReadArticle",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(t=>{if(t.errorCode==0)if(SetCookie("BWG_CC",t.token,15),t.jData.status){var i={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"subscriber",StrId:GetUrlParameter("StrId"),Order_No:"",OrderSeq:""}};fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0?Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg)))})}else Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)));else Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)))}))}function BwCoinReadArticle(){var n=getCookie("BWG_CC"),t;n.length!=0&&($("#ArticleIndexLoader").addClass("loader"),document.getElementById("ArticleIndexLoader").style.top="unset",$("#ArticleIndexUpdateMember").css("display","none"),t={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"bwcoin",StrId:GetUrlParameter("StrId"),IP:window.TokenBase.IP}},fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0?Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg))),$("#ArticleIndexLoader").removeClass("loader"),document.getElementById("ArticleIndexLoader").style.top=WindowHigh+"px",$("#ArticleIndexUpdateMember").css("display","")}))}function WhiteDiamondReadArticle(){var n=GetAtype()=="BWA"?"Article":"Digital";var t="https://m.businessweekly.com.tw/apis/utils/drainage?bwUrl="+encodeURI("https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")),f="https://bwplus.page.link/?link=https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802",i="",r={dynamicLinkInfo:{domainUriPrefix:"https://bwplus.page.link",link:t,androidInfo:{androidPackageName:"com.bwplus.reader"},iosInfo:{iosBundleId:"com.bw.business.ap02",iosAppStoreId:"1476799802"}},suffix:{option:"SHORT"}},u=isMobileDevice();fetch("https://firebasedynamiclinks.googleapis.com/v1/shortLinks?key=AIzaSyCE2iZMzH277cgCIMyW3kD-MRfoYWXwVbQ",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{i="https://bwplus.page.link/?link="+n.shortLink+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802";$("#qrcode").empty();$("#qrcode").qrcode({text:n.shortLink,width:160,height:160});var t=$("#qrcode canvas"),r=t[0].toDataURL("image/png");u?window.location.replace(n.shortLink):Alert2("<div class='text-center'><img src='"+r+"'><p class='p-3 fs-14 fw-bolder'>開啟商周App<br/>用商周白鑽解鎖付費文章<\/p><\/div >")})}function AIndexAddArticle(){var n=getCookie("BWG_CC"),t;n.length!=0&&(t={Token:n,JData:GetUrlParameter("StrId"),JData2:window.TokenBase.IP},fetch(rut+"API/AddArticleMark",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0?Alert(decodeURIComponent(encodeURIComponent(n.errorMsg))):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg)))}))}function GetUrlParameter(n){for(var i,u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return i[1]}function suspend_renew(n){var t=getCookie("BWG_CC"),i;t.length!=0&&(i={Token:t,JData:n},fetch(rut+"API/SuspendRenew",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{SetCookie("BWG_CC",n.token,15),Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location)}))}function isMobileDevice(){return["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].some(n=>navigator.userAgent.match(n))}function GetAtype(){var n=window.location.href;return n.includes("Digital")?"BWD":"BWA"}function Track(n,t,i,r,u){(new TrackEvents).setEvents(n,t,r,i,u)}function Track_Click_Event(n){document.querySelector(n.id)&&(n.id==="#paywall_option_impression_exchange_GD"?document.querySelector(n.id).addEventListener("click",function(){Track(n.t1,n.t2,n.target.getAttribute("value"),n.t4,n.t5)}):document.querySelector(n.id).addEventListener("click",function(){Track(n.t1,n.t2,n.t3,n.t4,n.t5)}))}function GetAtypeCode(){var i=window.location.href,n="4",t=GetAtype();return t=="BWD"&&(n="5"),n}var rut="/Archive/",ArticleIndex={Data:{IsRead:!1,IsFree:!1,moblie:!1,OId:null,Sdate:null,Edate:null},isMobileDevice:async function(){let n=["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].some(n=>navigator.userAgent.match(n));return n&&(ArticleIndex.Data.moblie=!0),n},BaseInfo:async function(){return["Android","webOS","iPhone","iPad","iPod","BlackBerry","Windows Phone"].some(n=>navigator.userAgent.match(n))},Archive_BaseInfo:async function(){var n=await ArticleIndex.getCookie("BWG_CC"),t;n.length!=0&&(t={Token:n,JData:{Archive_Type:"BWA",StrId:await ArticleIndex.GetUrlParameter("StrId")}},await fetch("https://apis.businessweekly.com.tw/member/v1/Archive/BaseInfo",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0&&(ArticleIndex.Data.IsRead=n.jData.isRead,ArticleIndex.Data.OId=n.jData.oId,ArticleIndex.Data.Sdate=n.jData.sdate,ArticleIndex.Data.Edate=n.jData.edate,await ArticleIndex.SetP3Ad2())}))},getCookie:async function(n){var t=document.cookie.match(new RegExp("(^| )"+n+"=([^;]*)(;|$)"));return t!=null?decodeURIComponent(t[2]):null},GetUrlParameter:async function(n){for(var i,u=window.location.search.substring(1),r=u.split("&"),t=0;t<r.length;t++)if(i=r[t].split("="),i[0]==n)return i[1]},GetRead:async function(){document.getElementById("type_r").value=="r"&&(ArticleIndex.Data.IsRead=!0)},GetFree:async function(){document.getElementById("type_f").value=="f"&&(ArticleIndex.Data.IsFree=!0)},GetDateDiff:async function(n,t){var i=new Date(n),r=new Date(t);return parseInt(Math.abs(i-r)/864e5)},Base:async function(){await window.BWGI();await ArticleIndex.GetRead();await ArticleIndex.GetFree();await ArticleIndex.isMobileDevice();await ArticleIndex.Archive_BaseInfo()},SetTopAd:async function(){var n={top_ad:"1972B164-1FFB-4D99-89F3-27D6D9DF9A58",top_ad_f:"1D639084-6E85-4A94-AF48-D3AFD4F1D319",top_mobile_ad:"754883DD-DB40-46B4-A8C2-F079A2BDE5C0",top_mobile_ad_f:"81C5DA5F-2424-4D2A-91A5-4F2791AC8AA6",ad:""},t;ArticleIndex.Data.IsRead||(n.ad=ArticleIndex.Data.moblie?ArticleIndex.Data.IsFree?n.top_mobile_ad_f:n.top_mobile_ad:ArticleIndex.Data.IsFree?n.top_ad_f:n.top_ad,t=document.getElementById("top_ad"),t.setAttribute("pid",n.ad))},SetP3Ad:async function(){var n={pd3_ad:"0A56F533-F32D-4A92-9791-461BAF9BE2AF",pd3_ad2:"03DC33A3-3873-4735-BF65-48FCFB66FA03",pd3_mobile_ad:"3694BF07-B131-4C6B-98F9-40E881955C34",pd3_mobile_ad2:"6CAA61B3-03D2-4B2F-A4B3-1F6481BB7534"},r,t,i,u,f;ArticleIndex.Data.IsFree&&!ArticleIndex.Data.IsRead&&(ArticleIndex.Data.moblie&&(n.pd3_ad=n.pd3_mobile_ad,n.pd3_ad2=n.pd3_mobile_ad2),r=document.querySelectorAll("#DivArticleIndexGetMore>p")[2],t=document.createElement("p"),t.setAttribute("style","text-align: center;"),i=document.createElement("div"),t.appendChild(i),i.setAttribute("id","pd3"),i.setAttribute("class","ad"),i.innerHTML="廣告",u=document.createElement("ins"),u.setAttribute("pid",n.pd3_ad),i.appendChild(u),f=document.createElement("ins"),f.setAttribute("pid",n.pd3_ad2),r&&u&&(r.parentNode.insertBefore(t,r.nextSibling),t.parentNode.insertBefore(f,t.nextSibling)))},SetP3Ad2:async function(){var n={pd3_ad_1_1_1_a:"E8090D2D-BDFA-46CD-8EFA-672FE4289120",pd3_ad_1_1_1_a_mobile:"5576EF08-79D8-437C-AC57-2EEF929A9207",pd3_ad_1_1_1_b:"90A5DE40-0C7B-4C82-A399-F89F4201C3FD",pd3_ad_1_1_1_b_mobile:"A0B7A456-5D04-4051-8F41-F75F602FDDDD",pd3_ad_1_2_1_a:"3DA849CC-4326-4957-9A92-7258445EE37C",pd3_ad_1_2_1_a_mobile:"7C47B3F4-948E-4A5F-A5C7-C78A7B9AD391",pd3_ad_1_2_1_b:"E89DB484-814F-421F-8BE8-2B7C2E117D45",pd3_ad_1_2_1_b_mobile:"CCAC0A13-1171-4C66-AA8C-E443B688A490",pd3_ad_1_2_2_a:"2276AC81-6802-40FF-A83D-620777EC7F18",pd3_ad_1_2_2_a_mobile:"3784C69A-F087-4567-AE07-BA0F77829AE0",pd3_ad_1_2_2_b:"DDD94279-5746-463E-97A2-E91B5B6A49C6",pd3_ad_1_2_2_b_mobile:"7711E8FB-CAC0-4195-AB4B-4A0EF2576F6F",pd3_ad_2_2_1_a:"A748E942-A591-4FEB-8EAE-BA3841CD2E01",pd3_ad_2_2_1_a_mobile:"5B0811B8-A49A-46FC-AF53-31A94A56B631",pd3_ad_2_2_1_b:"914F1C8A-2664-429C-BBFD-0D58FBBEE0A3",pd3_ad_2_2_1_b_mobile:"FA849CB0-ADD1-4F31-A1DC-0675BD64F42A",pd3_ad_2_2_2_a:"DB04C306-74DD-4F54-95A9-04E739F59917",pd3_ad_2_2_2_a_mobile:"2B83822C-F1E3-46E2-B33F-F2743FC5FAE0",pd3_ad_2_2_2_b:"F5431E23-63A5-49AE-A556-3B474167ECE2",pd3_ad_2_2_2_b_mobile:"9F69BA41-875E-4911-8283-B3F4424C2928",pd3_ad_2_2_3_a:"D908DFF5-968C-413A-A081-2A139C5C05D8",pd3_ad_2_2_3_a_mobile:"0927A3A0-F0E9-4754-8577-D9D8CE758331",pd3_ad_2_2_3_b:"29FFBD60-98F5-4201-9DEF-48401EA2BD5D",pd3_ad_2_2_3_b_mobile:"503B72BC-F327-4664-BE2A-F7FC48D438E1",rum:null},i,t;ArticleIndex.Data.IsRead&&ArticleIndex.Data.OId&&(i=await ArticleIndex.getCookie("BWG_CC"),t={Member_ID:window.TokenBase.Sum.toString(),Order_ID:ArticleIndex.Data.OId},await fetch("https://apis.businessweekly.com.tw/EC/1/API/Member/QueryArchiveMemberRenewInfo",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async t=>{var u=!1,r,i,f,e,o,s;t.jData.Order_ID&&t.jData.Member_ID.length!=0&&t.jData.Member_ID&&t.jData.Next_Vol_Count&&t.jData.Next_Vol_Count>0&&(u=!0);r=await ArticleIndex.GetDateDiff((new Date).toLocaleDateString(),ArticleIndex.Data.Edate);let h=new Date;i=h.getMonth();!u&&t.jData.Prod_Vol_Count<6&&r<=15&&r>=6&&(n.rum=ArticleIndex.Data.moblie?i%2==0?n.pd3_ad_1_2_1_b_mobile:n.pd3_ad_1_2_1_a_mobile:i%2==0?n.pd3_ad_1_2_1_b:n.pd3_ad_1_2_1_a);!u&&t.jData.Prod_Vol_Count<6&&r<=5&&(n.rum=ArticleIndex.Data.moblie?i%2==0?n.pd3_ad_1_2_2_b_mobile:n.pd3_ad_1_2_2_a_mobile:i%2==0?n.pd3_ad_1_2_2_b:n.pd3_ad_1_2_2_a);!u&&t.jData.Prod_Vol_Count>=6&&r<=90&&r>=46&&(console.log("2-2-1"),n.rum=ArticleIndex.Data.moblie?i%2==0?n.pd3_ad_2_2_1_b_mobile:n.pd3_ad_2_2_1_a_mobile:i%2==0?n.pd3_ad_2_2_1_b:n.pd3_ad_2_2_1_a);!u&&t.jData.Prod_Vol_Count>=6&&r<=45&&r>=21&&(n.rum=ArticleIndex.Data.moblie?i%2==0?n.pd3_ad_2_2_2_b_mobile:n.pd3_ad_2_2_2_a_mobile:i%2==0?n.pd3_ad_2_2_2_b:n.pd3_ad_2_2_2_a);!u&&t.jData.Prod_Vol_Count>=6&&r<=20&&r>=0&&(n.rum=ArticleIndex.Data.moblie?i%2==0?n.pd3_ad_2_2_3_b_mobile:n.pd3_ad_2_2_3_a_mobile:i%2==0?n.pd3_ad_2_2_3_b:n.pd3_ad_2_2_3_a);n.rum!=null&&(f=document.querySelectorAll("#DivArticleIndexGetMore>p")[2],e=document.createElement("p"),e.setAttribute("style","text-align: center;"),o=document.createElement("div"),e.appendChild(o),o.setAttribute("id","pd3"),s=document.createElement("ins"),s.setAttribute("pid",n.rum),o.appendChild(s),f&&s&&f.parentNode.insertBefore(e,f.nextSibling))}))},SetEpaperBlock:async function(){if(!ArticleIndex.Data.IsRead){var n=document.getElementById("Epaper-subscribe");n.classList.remove("remove")}},SetLastAd:async function(){var i={ad:"D5198BC1-980A-473E-814A-F86F129A3090"},n,t;ArticleIndex.Data.IsFree&&!ArticleIndex.Data.IsRead&&(ArticleIndex.Data.moblie&&(i.ad="08910994-C218-4205-880B-B486182CC952"),n=document.getElementById("last_ad"),n.setAttribute("class","ad"),n.setAttribute("style","background: unset;display: none;"),n.innerHTML="廣告",t=document.createElement("ins"),t.setAttribute("pid",i.ad),n.appendChild(t))},SetPostnavAd:async function(){var t,i,n,r,u;ArticleIndex.Data.IsFree&&!ArticleIndex.Data.IsRead&&ArticleIndex.Data.moblie&&(t=document.getElementById("PostnavAd"),t.setAttribute("class","ad"),i=document.createElement("ins"),i.setAttribute("pid","187B2503-5588-462F-B78C-AE0860CEB4CF"),t.appendChild(i),n=document.getElementById("mopopad"),n.setAttribute("class","ad"),r=document.createElement("ins"),r.setAttribute("pid","FECE11D6-47DB-4A1A-8049-2704CCE2D915"),u=document.createElement("adcover"),n.appendChild(u),n.appendChild(r))},Epaper_Subscribe:async function(){var n={Email:document.getElementById("Epaper_Subscribe_email").value,EpaperCategoryID:1};fetch("/Archive/API/SingleSubscribe",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(t=>{Track("epaper","subscription_1",n.Email,"paywall",null),Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)))})},adms:async function(){const n=document.createElement("script");n.src="https://admsapi.businessweekly.com.tw/ADMS.js";n.defer=!0;document.head.appendChild(n)}},CMS,paywall;$(document).ready(function(){var r=navigator.userAgent,i=document.documentElement.clientHeight,n,t;document.getElementById("ArticleIndexLoader")!=null&&(document.getElementById("ArticleIndexLoader").style.top=i+"px");document.getElementById("ArticleIndexNotEnd")!=null&&document.getElementById("ImageForGetMore")!=null&&(document.getElementById("ArticleIndexNotEnd").style.display=document.getElementById("ImageForGetMore").value);n=getCookie("ArticleIndexShopCarCk");n!=null&&n!=""&&(t=parseInt(n),t>0?(document.getElementById("ArticleIndexShopCarDiv").style.display="",document.getElementById("ArchiveShopCarItemCounts").innerHTML=decodeURIComponent(encodeURIComponent(n))):(document.getElementById("ArticleIndexShopCarDiv").style.display="none",document.getElementById("ArchiveShopCarItemCounts").innerHTML="0"))});window.addEventListener("load",()=>{document.querySelector("#paywall_option_impression_login")&&(document.querySelector("#paywall_option_impression_login").addEventListener("click",n=>{n.preventDefault(),Track("paywall","click_login","0",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}),document.querySelector("#paywall_option_impression_login2").addEventListener("click",n=>{n.preventDefault(),Track("paywall","click_subscription","0",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}));var n=[{id:"#paywall_option_impression_addvalue",t1:"paywall",t2:"click_addvalue",t3:"",t4:GetUrlParameter("StrId"),t5:"曝光事件 - 走儲值流程"},{id:"#paywall_option_impression_subscription",t1:"paywall",t2:"click_subscription",t3:"",t4:GetUrlParameter("StrId"),t5:"曝光事件 - 走訂閱流程"},{id:"#paywall_option_impression_goapp",t1:"paywall",t2:"click_goapp",t3:"",t4:GetUrlParameter("StrId"),t5:"曝光事件 - 顯示App QRCode"},{id:"#paywall_option_impression_4free",t1:"paywall",t2:"click_4free",t3:"b1",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_exchange_GD_b4",t1:"paywall",t2:"click_exchange_GD",t3:"b4",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_b4",t1:"paywall",t2:"click_subscription",t3:"b4",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_goapp_b3",t1:"paywall",t2:"click_goapp",t3:"b3",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_b3",t1:"paywall",t2:"click_addvalue",t3:"b3",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_b3",t1:"paywall",t2:"click_subscription",t3:"b3",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_b2",t1:"paywall",t2:"click_addvalue",t3:"b2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_b2",t1:"paywall",t2:"click_subscription",t3:"b2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_exchange_GD_g",t1:"paywall",t2:"click_exchange_GD",t3:"g",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_g",t1:"paywall",t2:"click_subscription",t3:"g",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_goapp_f",t1:"paywall",t2:"click_goapp",t3:"f",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_f",t1:"paywall",t2:"click_subscription",t3:"f",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_f",t1:"paywall",t2:"click_addvalue",t3:"f",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_goapp_f2",t1:"paywall",t2:"click_goapp",t3:"f2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_f2",t1:"paywall",t2:"click_subscription",t3:"f2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_f2",t1:"paywall",t2:"click_addvalue",t3:"f2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_checkin_d",t1:"paywall",t2:"click_checkin",t3:"d",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_d",t1:"paywall",t2:"click_subscription",t3:"d",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_d",t1:"paywall",t2:"click_addvalue",t3:"d",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_c",t1:"paywall",t2:"click_subscription",t3:"c",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_c",t1:"paywall",t2:"click_addvalue",t3:"c",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_c2",t1:"paywall",t2:"click_subscription",t3:"c2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_c2",t1:"paywall",t2:"click_addvalue",t3:"c2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_i",t1:"paywall",t2:"click_subscription",t3:"i",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_i2",t1:"paywall",t2:"click_subscription",t3:"i2",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_bi",t1:"paywall",t2:"click_subscription",t3:"bi",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_addvalue_k",t1:"paywall",t2:"click_addvalue",t3:"k",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null},{id:"#paywall_option_impression_subscription_k",t1:"paywall",t2:"click_subscription",t3:"k",t4:GetAtypeCode()+"-"+GetUrlParameter("StrId"),t5:null}];n.forEach(n=>Track_Click_Event(n))});let paywall_option_login=document.getElementById("paywall_option_login"),PayWall_k=document.getElementById("PayWall_k"),receiveData={};if(paywall_option_login){const n=function(n,t){if(n[0].isIntersecting)try{let i=n[0].target.id;switch(i){case"paywall_option_login":Track("paywall","impression","0",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b1":Track("paywall","impression","b1",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b4":Track("paywall","impression","b4",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b3":Track("paywall","impression","b3",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b2":Track("paywall","impression","b2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_g":Track("paywall","impression","g",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_f":Track("paywall","impression","f",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_f2":Track("paywall","impression","f2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_c":Track("paywall","impression","c",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_c2":Track("paywall","impression","c2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_d":Track("paywall","impression","d",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_i":Track("paywall","impression","i",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_i2":Track("paywall","impression","i2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_bi":Track("paywall","impression","bi",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}t.unobserve(n[0].target)}catch(i){throw i;}},t=new IntersectionObserver(n,{root:null,rootMargin:"0px 0px 0px 0px",threshold:0});paywall_option_login&&setTimeout(()=>{t.observe(paywall_option_login)},200)}$(async function(){await ArticleIndex.Base();await ArticleIndex.SetTopAd();await ArticleIndex.SetP3Ad();await ArticleIndex.SetEpaperBlock();await ArticleIndex.SetLastAd();await ArticleIndex.SetPostnavAd();await ArticleIndex.adms()});$(document).on("ajaxSuccess",function(n,t,i){var u,r;i.type=="POST"&&i.url=="https://admsapi.businessweekly.com.tw/api/ADMS/"&&t.status==200&&(u=t.responseJSON,u.filter(n=>n.PanelId==="81C5DA5F-2424-4D2A-91A5-4F2791AC8AA6"||n.PanelId==="754883DD-DB40-46B4-A8C2-F079A2BDE5C0"||n.PanelId==="1D639084-6E85-4A94-AF48-D3AFD4F1D319"||n.PanelId==="1972B164-1FFB-4D99-89F3-27D6D9DF9A58").length>0&&(r=document.getElementById("top_ad"),r.style.display=null),u.filter(n=>n.PanelId==="3694BF07-B131-4C6B-98F9-40E881955C34"||n.PanelId==="0A56F533-F32D-4A92-9791-461BAF9BE2AF").length>0&&(r=document.getElementById("pd3"),r.style.display="inline-flex"),u.filter(n=>n.PanelId==="08910994-C218-4205-880B-B486182CC952"||n.PanelId==="D5198BC1-980A-473E-814A-F86F129A3090").length>0&&(r=document.getElementById("last_ad"),r.style.display=null),u.filter(n=>n.PanelId==="187B2503-5588-462F-B78C-AE0860CEB4CF"||n.PanelId==="FECE11D6-47DB-4A1A-8049-2704CCE2D915").length>0&&(r=document.getElementById("PostnavAd"),r.style.display=null))});if(document.getElementById("CMS_514999")){CMS=new Vue({el:"#CMS_514999",data:{detail:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null}},template:`
        <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                <div class="row m-t-32">
                    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                        <img :src='detail.imgUrl' style='max-width:100%'/>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                        <div class='fs-24'>{{detail.title}}</div>
                        <div class="m-t-16" v-html="detail.content"></div>
                        <div class="fs-16" style="font-weight: bold; text-align:center; color:#fff">
                            <span id="paywall_option_impression_subscription_i" style="padding: 8px 40px 10px; border-radius: 21px; background-color: #cd0505; cursor: pointer;" class="paywall_btn_cd0505" onclick="paywallController(0,@Model.CT_Magazine.Price);">
                            {{detail.subTitle}}
                            </span>
                        </div>
                    </div>
                </div>               
        </div>
        `,mounted:async function(){var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:"514999"}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0&&(this.detail=n.jData)})}});paywall=new Vue({el:"#paywall_subscriber",data:{titleurl:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null},layout:{id:null,Bwcoin:0,WhiteDiamond:0,goldDiamondCount:0,pType:null,value:null,cms:null,isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1},cms:{google:"515005",member:"515002",subscriber:"514999"},ptye:{google:"PTYPE00000397",member:"PTYPE00000395",subscriber:"PTYPE00000396"},Referer:"none",issale:!1,Price:0,Bwcoin:0,WhiteDiamond:0,Role_Num:0},template:`
        <div id="ArticleIndexUpdateMember" class="newpaywall-2">
            <div :id="layout.id" class="pawall">
                <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                    <div class="row m-t-32">
                        <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                            <img :src='titleurl.imgUrl' style='max-width:100%'/>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7 p-b-32" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                            <div class='fs-24'>
                                {{titleurl.title}}
                            </div>
                            <div v-if="layout.isfreeread" class="px-3 fs-20 center h2" style=" font-weight: bold;  font-stretch: normal;  font-style: normal;">
                                本月還有 <span class="alink2">{{Role_Num}}</span> 篇免費閱讀
                            </div>
                            <div class="m-t-16" v-html="titleurl.content"></div>
                             <div class="fs-16 center" style="font-weight: bold; color:#fff">
                             <span v-if="layout.isfreeread" v-on:click="AIndexReadArticle();" class="paybtn paywall_btn_333 me-2">
                                     點擊閱讀全文
                                </span>
                                <span v-if="layout.isSinglebuy" v-on:click="BwCoinReadArticle();" class="paybtn paywall_btn_333 me-2">
                                    {{layout.goldDiamondCount}}鑽兌換
                                </span>
                                <span v-if="layout.issubscription" v-on:click="subscription();" class="paybtn paywall_btn_cd0505">
                                    {{titleurl.subTitle}}
                                </span>
                             </div>
                        </div>
                    </div>
                </div>
                <div v-if="layout.isNotSale" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    本篇僅限訂閱會員閱讀，恕不開放單篇兌換
                </div>
                <div v-if="layout.isSinglebuy" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有金鑽 : <span class="alink2">{{Bwcoin}}</span> 枚
                </div>
                <div v-if="layout.isWhiteDiamond" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有白鑽 : <span class="alink2">{{WhiteDiamond}}</span> 枚<br />
                    兌換本文需要商周鑽 {{layout.goldDiamondCount}}(<span  class="alink" v-on:click="WhiteDiamondReadArticle();">開啟App兌換</span>)
                </div>
                <div v-if="layout.isAddvalue" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有金鑽 : <span class="alink2">{{Bwcoin}}</span> 枚<br />
                    兌換本文需要商周鑽 {{layout.goldDiamondCount}}(<span  class="alink" v-on:click="addvalue();">先儲值金鑽</span>)
                </div>
            </div>
        </div>
        `,methods:{BwCoinReadArticle:async function(){var n=getCookie("BWG_CC"),t;n.length!=0&&($("#ArticleIndexLoader").addClass("loader"),document.getElementById("ArticleIndexLoader").style.top="unset",$("#ArticleIndexUpdateMember").css("display","none"),t={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"bwcoin",StrId:GetUrlParameter("StrId"),IP:window.TokenBase.IP}},fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0?(await this.Track("paywall","click_exchange_GD",this.layout.goldDiamondCount,GetAtypeCode()+"-"+GetUrlParameter("StrId"),"曝光事件 - 金鑽兌換文章"),Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href)):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg))),$("#ArticleIndexLoader").removeClass("loader"),document.getElementById("ArticleIndexLoader").style.top=WindowHigh+"px",$("#ArticleIndexUpdateMember").css("display","")}))},subscription:async function(){await this.Track("paywall","click_subscription",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);paywallController(0,this.layout.goldDiamondCount,this.layout.pType)},addvalue:async function(){await this.Track("paywall","click_addvalue",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);paywallController(1,this.layout.goldDiamondCount,this.layout.pType)},WhiteDiamondReadArticle:async function(){var n;await this.Track("paywall","click_goapp","f",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);n="";n=GetAtype()=="BWA"?"Article":"Digital";var t="https://m.businessweekly.com.tw/apis/utils/drainage?bwUrl="+encodeURI("https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")),f="https://bwplus.page.link/?link=https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802",i="",r={dynamicLinkInfo:{domainUriPrefix:"https://bwplus.page.link",link:t,androidInfo:{androidPackageName:"com.bwplus.reader"},iosInfo:{iosBundleId:"com.bw.business.ap02",iosAppStoreId:"1476799802"}},suffix:{option:"SHORT"}},u=isMobileDevice();fetch("https://firebasedynamiclinks.googleapis.com/v1/shortLinks?key=AIzaSyCE2iZMzH277cgCIMyW3kD-MRfoYWXwVbQ",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{i="https://bwplus.page.link/?link="+n.shortLink+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802";$("#qrcode").empty();$("#qrcode").qrcode({text:n.shortLink,width:160,height:160});var t=$("#qrcode canvas"),r=t[0].toDataURL("image/png");u?window.location.replace(n.shortLink):Alert2("<div class='text-center'><img src='"+r+"'><p class='p-3 fs-14 fw-bolder'>開啟商周App<br/>用商周白鑽解鎖付費文章<\/p><\/div >")})},AIndexReadArticle:async function(){var n,t;await this.Track("paywall","b1",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);n=getCookie("BWG_CC");n.length!=0&&(t={Token:n,JData:{ArticleId:document.getElementById("ArticleIndex_id").value}},fetch(rut+"API/ReadArticle",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(t=>{if(t.errorCode==0)if(SetCookie("BWG_CC",t.token,15),t.jData.status){var i={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"subscriber",StrId:GetUrlParameter("StrId"),Order_No:"",OrderSeq:""}};fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0?Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg)))})}else Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)));else Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)))}))},Track:async function(n,t,i,r,u){(new TrackEvents).setEvents(n,t,r,i,u)}},mounted:async function(){this.issale=document.getElementById("IsSale").value=="True"?!0:!1;this.Price=parseInt(document.getElementById("Price").value,10);this.Bwcoin=parseInt(document.getElementById("Bwcoin").value,10);this.WhiteDiamond=parseInt(document.getElementById("WhiteDiamond").value,10);this.Referer=document.getElementById("Referer").value;this.Role_Num=parseInt(document.getElementById("Role_Num").value,10);this.layout=this.issale&&this.Price!=0?this.Role_Num>0?this.Referer=="google"?{id:"PayWall_b12",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b12",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!0}:{id:"PayWall_b1",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b1",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!0}:this.Bwcoin>=this.Price?this.Referer=="google"?{id:"PayWall_b42",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b42",isNotSale:!1,issubscription:!0,isSinglebuy:!0,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_b4",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b4",isNotSale:!1,issubscription:!0,isSinglebuy:!0,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:this.Bwcoin<this.Price&&this.WhiteDiamond>=this.Price?this.Referer=="google"?{id:"PayWall_b32",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b3",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!0,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_b3",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b3",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!0,isAddvalue:!1,isfreeread:!1}:this.Referer=="google"?{id:"PayWall_b22",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b2",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!0,isfreeread:!1}:{id:"PayWall_b2",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b2",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!0,isfreeread:!1}:this.Referer=="google"?{id:"PayWall_bi2",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"bi2",isNotSale:!0,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_bi",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"bi",isNotSale:!0,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1};var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:this.layout.cms}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0&&(this.titleurl=n.jData)})}});let c=document.getElementById("ArticleIndexUpdateMember"),n=document.getElementById("PayWall_bi"),t=document.getElementById("PayWall_bi2"),i=document.getElementById("PayWall_b1"),r=document.getElementById("PayWall_b12"),u=document.getElementById("PayWall_b4"),f=document.getElementById("PayWall_b42"),e=document.getElementById("PayWall_b3"),o=document.getElementById("PayWall_b32"),s=document.getElementById("PayWall_b2"),h=document.getElementById("PayWall_b22");if(c){const l=function(n,t){if(n[0].isIntersecting)try{let i=n[0].target.id;switch(i){case"PayWall_bi":Track("paywall","impression","bi",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_bi2":Track("paywall","impression","bi2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b1":Track("paywall","impression","b1",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b12":Track("paywall","impression","b12",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b4":Track("paywall","impression","b4",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b42":Track("paywall","impression","b42",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b3":Track("paywall","impression","b3",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b32":Track("paywall","impression","b32",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b2":Track("paywall","impression","b2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b22":Track("paywall","impression","b22",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}t.unobserve(n[0].target)}catch(i){throw i;}},c=new IntersectionObserver(l,{root:null,rootMargin:"0px 0px 0px 0px",threshold:0});n&&setTimeout(()=>{c.observe(n)},200);t&&setTimeout(()=>{c.observe(t)},200);i&&setTimeout(()=>{c.observe(i)},200);r&&setTimeout(()=>{c.observe(r)},200);u&&setTimeout(()=>{c.observe(u)},200);f&&setTimeout(()=>{c.observe(f)},200);e&&setTimeout(()=>{c.observe(e)},200);o&&setTimeout(()=>{c.observe(o)},200);s&&setTimeout(()=>{c.observe(s)},200);h&&setTimeout(()=>{c.observe(h)},200)}}if(document.getElementById("CMS_515002")&&(CMS=new Vue({el:"#CMS_515002",data:{detail:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null}},template:`
        <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                <div class="row m-t-32">
                    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                        <img :src='detail.imgUrl' style='max-width:100%'/>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                        <div class='fs-24'>{{detail.title}}</div>
                        <div class="m-t-16 fs-16" v-html="detail.content"></div>
                        <div class='fs-16' style="font-weight: bold; text-align:center; color:#fff">
                            <span id="paywall_option_impression_subscription_i" style="padding: 8px 40px 10px; border-radius: 21px; background-color: #cd0505; cursor: pointer;" class="paywall_btn_cd0505" data-member="bw" data-type="login" onclick="paywall_option_impression_login()">
                            {{detail.subTitle}}
                            </span>
                        </div>
                    </div>
                </div>               
        </div>
        `,mounted:async function(){var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:"515002"}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0&&(this.detail=n.jData)})}})),document.getElementById("CMS_515005")&&(CMS=new Vue({el:"#CMS_515005",data:{detail:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null}},template:`
        <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                <div class="row m-t-32">
                    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                        <img :src='detail.imgUrl' style='max-width:100%'/>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                        <div class='fs-24'>{{detail.title}}</div>
                        <div class="m-t-16 fs-16" v-html="detail.content"></div>
                        <div class='fs-16' style="font-weight: bold; text-align:center; color:#fff">
                            <span id="paywall_option_impression_subscription_c2" style="padding: 8px 40px 10px; border-radius: 21px; background-color: #cd0505; cursor: pointer;" class=" paywall_btn_cd0505" onclick="paywallController(0,@Model.CT_Magazine.Price);">
                            {{detail.subTitle}}
                            </span>
                        </div>
                    </div>
                </div>               
        </div>
        `,mounted:async function(){var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:"515005"}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0&&(this.detail=n.jData)})}})),document.getElementById("paywall_login")){paywall=new Vue({el:"#paywall_login",data:{titleurl:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null},layout:{id:null,Bwcoin:0,WhiteDiamond:0,goldDiamondCount:0,pType:null,cms:null,value:null,isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1},cms:{google:"515005",member:"515002",subscriber:"514999"},ptye:{google:"PTYPE00000397",member:"PTYPE00000395",subscriber:"PTYPE00000396"},Referer:"none",issale:!1,Price:0,Bwcoin:0,WhiteDiamond:0},template:`
        <div id="paywall_option_login" class="newpaywall-2">
            <div class="fs-16 p-t-32 center">
                我已經是訂戶，
                    <span class="alink fw-bolder-500 js-login js-iframe-login" data-member="bw" data-type="login" v-on:click="paywall_option_impression_login()">
                        登入
                    </span>
                立即看
            </div>
            <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                <div class="row m-t-32">
                    <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                        <img :src='titleurl.imgUrl' style='max-width:100%'/>
                    </div>
                    <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                        <div class='fs-24'>
                            {{titleurl.title}}
                        </div>
                        <div class="m-t-16" v-html="titleurl.content"></div>
                        <div class="fs-16 center" style="font-weight: bold; color:#fff">
                            <span data-member="bw" data-type="login" class="paybtn paywall_btn_cd0505 me-2">
                                馬上訂閱→
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                或是登入儲值，單次
                    <span id="paywall_option_impression_login2" class="alink fw-bolder-500 js-login js-iframe-login" data-member="bw" data-type="login" v-on:click="paywall_option_impression_login2()">
                        閱讀本文
                    </span>
            </div>
        </div>
       
        `,methods:{paywall_option_impression_login:async function(){Track("paywall","click_login","0",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)},paywall_option_impression_login2:async function(){Track("paywall","click_subscription","0",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}},mounted:async function(){this.issale=document.getElementById("IsSale").value=="True"?!0:!1;this.Price=parseInt(document.getElementById("Price").value,10);this.Bwcoin=parseInt(document.getElementById("Bwcoin").value,10);this.WhiteDiamond=parseInt(document.getElementById("WhiteDiamond").value,10);this.Referer=document.getElementById("Referer").value;this.layout=this.Referer=="google"?{id:"paywall_option_impression_login",goldDiamondCount:this.Price,pType:this.ptye.google,cms:this.cms.google,value:"login2",isNotSale:!1,issubscription:!1,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"paywall_option_impression_login",goldDiamondCount:this.Price,pType:this.ptye.member,cms:this.cms.member,value:"login",isNotSale:!1,issubscription:!1,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1};var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:this.layout.cms}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0&&(this.titleurl=n.jData)})}});let n=document.getElementById("paywall_option_login");if(n){const t=function(n,t){if(n[0].isIntersecting)try{let i=n[0].target.id;switch(i){case"paywall_option_login":Track("paywall","impression","0",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}t.unobserve(n[0].target)}catch(i){throw i;}},i=new IntersectionObserver(t,{root:null,rootMargin:"0px 0px 0px 0px",threshold:0});n&&setTimeout(()=>{i.observe(n)},200)}}if(document.getElementById("paywall_member")){paywall=new Vue({el:"#paywall_member",data:{titleurl:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null},layout:{id:null,Bwcoin:0,WhiteDiamond:0,goldDiamondCount:0,pType:null,cms:null,value:null,isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1},cms:{google:"515005",member:"515002",subscriber:"514999"},ptye:{google:"PTYPE00000397",member:"PTYPE00000395",subscriber:"PTYPE00000396"},Referer:"none",issale:!1,Price:0,Bwcoin:0,WhiteDiamond:0},template:`
        <div id="ArticleIndexUpdateMember" class="newpaywall-2">
            <div :id="layout.id" class="pawall">
                <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                    <div class="row m-t-32">
                        <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                            <img :src='titleurl.imgUrl' style='max-width:100%'/>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                            <div class='fs-24'>
                                {{titleurl.title}}
                            </div>
                            <div class="m-t-16" v-html="titleurl.content"></div>
                             <div class="fs-16 center" style="font-weight: bold; color:#fff">
                                <span v-if="layout.isSinglebuy" v-on:click="BwCoinReadArticle();" class="paybtn paywall_btn_333 me-2">
                                    {{layout.goldDiamondCount}}鑽兌換
                                </span>
                                <span v-if="layout.issubscription" v-on:click="subscription();" class="paybtn paywall_btn_cd0505">
                                    {{titleurl.subTitle}}
                                </span>
                             </div>
                        </div>
                    </div>
                </div>
                <div v-if="layout.isNotSale" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    本篇僅限訂閱會員閱讀，恕不開放單篇兌換
                </div>
                <div v-if="layout.isSinglebuy" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有金鑽 : <span class="alink2">{{Bwcoin}}</span> 枚
                </div>
                <div v-if="layout.isWhiteDiamond" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有白鑽 : <span class="alink2">{{WhiteDiamond}}</span> 枚<br />
                    兌換本文需要商周鑽 {{layout.goldDiamondCount}}(<span  class="alink" v-on:click="WhiteDiamondReadArticle();">開啟App兌換</span>)
                </div>
                <div v-if="layout.isAddvalue" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有金鑽 : <span class="alink2">{{Bwcoin}}</span> 枚<br />
                    兌換本文需要商周鑽 {{layout.goldDiamondCount}}(<span  class="alink" v-on:click="addvalue();">先儲值金鑽</span>)
                </div>
            </div>
        </div>
        `,methods:{BwCoinReadArticle:async function(){var n=getCookie("BWG_CC"),t;n.length!=0&&($("#ArticleIndexLoader").addClass("loader"),document.getElementById("ArticleIndexLoader").style.top="unset",$("#ArticleIndexUpdateMember").css("display","none"),t={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"bwcoin",StrId:GetUrlParameter("StrId"),IP:window.TokenBase.IP}},fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0?(await this.Track("paywall","click_exchange_GD",this.layout.goldDiamondCount,GetAtypeCode()+"-"+GetUrlParameter("StrId"),"曝光事件 - 金鑽兌換文章"),Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href)):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg))),$("#ArticleIndexLoader").removeClass("loader"),document.getElementById("ArticleIndexLoader").style.top=WindowHigh+"px",$("#ArticleIndexUpdateMember").css("display","")}))},subscription:async function(){await this.Track("paywall","click_subscription",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);paywallController(0,this.layout.goldDiamondCount,this.layout.pType)},addvalue:async function(){await this.Track("paywall","click_addvalue",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);paywallController(1,this.layout.goldDiamondCount,this.layout.pType)},WhiteDiamondReadArticle:async function(){var n;await this.Track("paywall","click_goapp","f",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);n="";n=GetAtype()=="BWA"?"Article":"Digital";var t="https://m.businessweekly.com.tw/apis/utils/drainage?bwUrl="+encodeURI("https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")),f="https://bwplus.page.link/?link=https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802",i="",r={dynamicLinkInfo:{domainUriPrefix:"https://bwplus.page.link",link:t,androidInfo:{androidPackageName:"com.bwplus.reader"},iosInfo:{iosBundleId:"com.bw.business.ap02",iosAppStoreId:"1476799802"}},suffix:{option:"SHORT"}},u=isMobileDevice();fetch("https://firebasedynamiclinks.googleapis.com/v1/shortLinks?key=AIzaSyCE2iZMzH277cgCIMyW3kD-MRfoYWXwVbQ",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{i="https://bwplus.page.link/?link="+n.shortLink+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802";$("#qrcode").empty();$("#qrcode").qrcode({text:n.shortLink,width:160,height:160});var t=$("#qrcode canvas"),r=t[0].toDataURL("image/png");u?window.location.replace(n.shortLink):Alert2("<div class='text-center'><img src='"+r+"'><p class='p-3 fs-14 fw-bolder'>開啟商周App<br/>用商周白鑽解鎖付費文章<\/p><\/div >")})},Track:async function(n,t,i,r,u){(new TrackEvents).setEvents(n,t,r,i,u)}},mounted:async function(){this.issale=document.getElementById("IsSale").value=="True"?!0:!1;this.Price=parseInt(document.getElementById("Price").value,10);this.Bwcoin=parseInt(document.getElementById("Bwcoin").value,10);this.WhiteDiamond=parseInt(document.getElementById("WhiteDiamond").value,10);this.Referer=document.getElementById("Referer").value;this.layout=this.issale&&this.Price!=0?this.Bwcoin>=this.Price?this.Referer=="google"?{id:"PayWall_g2",goldDiamondCount:this.Price,pType:this.ptye.google,cms:this.cms.google,value:"g2",isNotSale:!1,issubscription:!0,isSinglebuy:!0,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_g",goldDiamondCount:this.Price,pType:this.ptye.member,cms:this.cms.member,value:"g",isNotSale:!1,issubscription:!0,isSinglebuy:!0,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:this.Bwcoin<this.Price&&this.WhiteDiamond>=this.Price?this.Referer=="google"?{id:"PayWall_f2",goldDiamondCount:this.Price,pType:this.ptye.google,cms:this.cms.google,value:"f2",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!0,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_f",goldDiamondCount:this.Price,pType:this.ptye.member,cms:this.cms.member,value:"f",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!0,isAddvalue:!1,isfreeread:!1}:this.Referer=="google"?{id:"PayWall_c2",goldDiamondCount:this.Price,pType:this.ptye.google,cms:this.cms.google,value:"c2",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!0,isfreeread:!1}:{id:"PayWall_c",goldDiamondCount:this.Price,pType:this.ptye.member,cms:this.cms.member,value:"c",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!0,isfreeread:!1}:this.Referer=="google"?{id:"PayWall_i2",goldDiamondCount:this.Price,pType:this.ptye.google,cms:this.cms.google,value:"i2",isNotSale:!0,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_i",goldDiamondCount:this.Price,pType:this.ptye.member,cms:this.cms.member,value:"i",isNotSale:!0,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1};var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:this.layout.cms}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0&&(this.titleurl=n.jData)})}});let s=document.getElementById("ArticleIndexUpdateMember"),n=document.getElementById("PayWall_i"),t=document.getElementById("PayWall_i2"),i=document.getElementById("PayWall_g"),r=document.getElementById("PayWall_g2"),u=document.getElementById("PayWall_f"),f=document.getElementById("PayWall_f2"),e=document.getElementById("PayWall_c"),o=document.getElementById("PayWall_c2");if(s){const h=function(n,t){if(n[0].isIntersecting)try{let i=n[0].target.id;switch(i){case"PayWall_i":Track("paywall","impression","i",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_i2":Track("paywall","impression","i2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_g":Track("paywall","impression","g",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_g2":Track("paywall","impression","g2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_f":Track("paywall","impression","f",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_f2":Track("paywall","impression","f2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_c":Track("paywall","impression","c",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_c2":Track("paywall","impression","c2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}t.unobserve(n[0].target)}catch(i){throw i;}},s=new IntersectionObserver(h,{root:null,rootMargin:"0px 0px 0px 0px",threshold:0});n&&setTimeout(()=>{s.observe(n)},200);t&&setTimeout(()=>{s.observe(t)},200);i&&setTimeout(()=>{s.observe(i)},200);r&&setTimeout(()=>{s.observe(r)},200);u&&setTimeout(()=>{s.observe(u)},200);f&&setTimeout(()=>{s.observe(f)},200);e&&setTimeout(()=>{s.observe(e)},200);o&&setTimeout(()=>{s.observe(o)},200)}}if(document.getElementById("paywall_subscriber")){paywall=new Vue({el:"#paywall_subscriber",data:{titleurl:{title:null,subTitle:null,linkUrl:null,imgUrl:null,imgUrl_M:null,content:null},layout:{id:null,Bwcoin:0,WhiteDiamond:0,goldDiamondCount:0,pType:null,value:null,cms:null,isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1},cms:{google:"515005",member:"515002",subscriber:"514999"},ptye:{google:"PTYPE00000397",member:"PTYPE00000395",subscriber:"PTYPE00000396"},Referer:"none",issale:!1,Price:0,Bwcoin:0,WhiteDiamond:0,Role_Num:0},template:`
        <div id="ArticleIndexUpdateMember" class="newpaywall-2">
            <div :id="layout.id" class="pawall">
                <div class="p-t-20" style="border-top:2px solid red; margin-bottom: 32px;">
                    <div class="row m-t-32">
                        <div class="col-xs-12 col-sm-12 col-md-5 col-lg-5 center">
                            <img :src='titleurl.imgUrl' style='max-width:100%'/>
                        </div>
                        <div class="col-xs-12 col-sm-12 col-md-7 col-lg-7 p-b-32" style="font-weight: bold;  font-stretch: normal;  font-style: normal">
                            <div class='fs-24'>
                                {{titleurl.title}}
                            </div>
                            <div v-if="layout.isfreeread" class="px-3 fs-20 center h2" style=" font-weight: bold;  font-stretch: normal;  font-style: normal;">
                                本月還有 <span class="alink2">{{Role_Num}}</span> 篇免費閱讀
                            </div>
                            <div class="m-t-16" v-html="titleurl.content"></div>
                             <div class="fs-16 center" style="font-weight: bold; color:#fff">
                             <span v-if="layout.isfreeread" v-on:click="AIndexReadArticle();" class="paybtn paywall_btn_333 me-2">
                                     點擊閱讀全文
                                </span>
                                <span v-if="layout.isSinglebuy" v-on:click="BwCoinReadArticle();" class="paybtn paywall_btn_333 me-2">
                                    {{layout.goldDiamondCount}}鑽兌換
                                </span>
                                <span v-if="layout.issubscription" v-on:click="subscription();" class="paybtn paywall_btn_cd0505">
                                    {{titleurl.subTitle}}
                                </span>
                             </div>
                        </div>
                    </div>
                </div>
                <div v-if="layout.isNotSale" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    本篇僅限訂閱會員閱讀，恕不開放單篇兌換
                </div>
                <div v-if="layout.isSinglebuy" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有金鑽 : <span class="alink2">{{Bwcoin}}</span> 枚
                </div>
                <div v-if="layout.isWhiteDiamond" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有白鑽 : <span class="alink2">{{WhiteDiamond}}</span> 枚<br />
                    兌換本文需要商周鑽 {{layout.goldDiamondCount}}(<span  class="alink" v-on:click="WhiteDiamondReadArticle();">開啟App兌換</span>)
                </div>
                <div v-if="layout.isAddvalue" class="m-t-16 p-t-32 p-b-32 center lastinfo_box">
                    你有金鑽 : <span class="alink2">{{Bwcoin}}</span> 枚<br />
                    兌換本文需要商周鑽 {{layout.goldDiamondCount}}(<span  class="alink" v-on:click="addvalue();">先儲值金鑽</span>)
                </div>
            </div>
        </div>
        `,methods:{BwCoinReadArticle:async function(){var n=getCookie("BWG_CC"),t;n.length!=0&&($("#ArticleIndexLoader").addClass("loader"),document.getElementById("ArticleIndexLoader").style.top="unset",$("#ArticleIndexUpdateMember").css("display","none"),t={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"bwcoin",StrId:GetUrlParameter("StrId"),IP:window.TokenBase.IP}},fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0?(await this.Track("paywall","click_exchange_GD",this.layout.goldDiamondCount,GetAtypeCode()+"-"+GetUrlParameter("StrId"),"曝光事件 - 金鑽兌換文章"),Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href)):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg))),$("#ArticleIndexLoader").removeClass("loader"),document.getElementById("ArticleIndexLoader").style.top=WindowHigh+"px",$("#ArticleIndexUpdateMember").css("display","")}))},subscription:async function(){await this.Track("paywall","click_subscription",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);paywallController(0,this.layout.goldDiamondCount,this.layout.pType)},addvalue:async function(){await this.Track("paywall","click_addvalue",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);paywallController(1,this.layout.goldDiamondCount,this.layout.pType)},WhiteDiamondReadArticle:async function(){var n;await this.Track("paywall","click_goapp","f",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);n="";n=GetAtype()=="BWA"?"Article":"Digital";var t="https://m.businessweekly.com.tw/apis/utils/drainage?bwUrl="+encodeURI("https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")),f="https://bwplus.page.link/?link=https://www.businessweekly.com.tw/Archive/"+n+"?StrId="+GetUrlParameter("StrId")+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802",i="",r={dynamicLinkInfo:{domainUriPrefix:"https://bwplus.page.link",link:t,androidInfo:{androidPackageName:"com.bwplus.reader"},iosInfo:{iosBundleId:"com.bw.business.ap02",iosAppStoreId:"1476799802"}},suffix:{option:"SHORT"}},u=isMobileDevice();fetch("https://firebasedynamiclinks.googleapis.com/v1/shortLinks?key=AIzaSyCE2iZMzH277cgCIMyW3kD-MRfoYWXwVbQ",{method:"POST",body:JSON.stringify(r),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{i="https://bwplus.page.link/?link="+n.shortLink+"&apn=com.bwplus.reader&ibi=com.bw.business.ap02&isi=1476799802";$("#qrcode").empty();$("#qrcode").qrcode({text:n.shortLink,width:160,height:160});var t=$("#qrcode canvas"),r=t[0].toDataURL("image/png");u?window.location.replace(n.shortLink):Alert2("<div class='text-center'><img src='"+r+"'><p class='p-3 fs-14 fw-bolder'>開啟商周App<br/>用商周白鑽解鎖付費文章<\/p><\/div >")})},AIndexReadArticle:async function(){var n,t;await this.Track("paywall","b1",this.layout.value,GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);n=getCookie("BWG_CC");n.length!=0&&(t={Token:n,JData:{ArticleId:document.getElementById("ArticleIndex_id").value}},fetch(rut+"API/ReadArticle",{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(t=>{if(t.errorCode==0)if(SetCookie("BWG_CC",t.token,15),t.jData.status){var i={Token:n,JData:{Archive_Type:GetAtype(),Buy_Type:"subscriber",StrId:GetUrlParameter("StrId"),Order_No:"",OrderSeq:""}};fetch("https://apis.businessweekly.com.tw/member/v1/Archive/SingleBuy",{method:"POST",body:JSON.stringify(i),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(n=>{n.errorCode==0?Return(decodeURIComponent(encodeURIComponent(n.errorMsg)),window.location.href):Alert(decodeURIComponent(encodeURIComponent(n.errorMsg)))})}else Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)));else Alert(decodeURIComponent(encodeURIComponent(t.errorMsg)))}))},Track:async function(n,t,i,r,u){(new TrackEvents).setEvents(n,t,r,i,u)}},mounted:async function(){this.issale=document.getElementById("IsSale").value=="True"?!0:!1;this.Price=parseInt(document.getElementById("Price").value,10);this.Bwcoin=parseInt(document.getElementById("Bwcoin").value,10);this.WhiteDiamond=parseInt(document.getElementById("WhiteDiamond").value,10);this.Referer=document.getElementById("Referer").value;this.Role_Num=parseInt(document.getElementById("Role_Num").value,10);this.layout=this.issale&&this.Price!=0?this.Role_Num>0?this.Referer=="google"?{id:"PayWall_b12",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b12",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!0}:{id:"PayWall_b1",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b1",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!0}:this.Bwcoin>=this.Price?this.Referer=="google"?{id:"PayWall_b42",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b42",isNotSale:!1,issubscription:!0,isSinglebuy:!0,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_b4",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b4",isNotSale:!1,issubscription:!0,isSinglebuy:!0,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:this.Bwcoin<this.Price&&this.WhiteDiamond>=this.Price?this.Referer=="google"?{id:"PayWall_b32",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b3",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!0,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_b3",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b3",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!0,isAddvalue:!1,isfreeread:!1}:this.Referer=="google"?{id:"PayWall_b22",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b2",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!0,isfreeread:!1}:{id:"PayWall_b2",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"b2",isNotSale:!1,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!0,isfreeread:!1}:this.Referer=="google"?{id:"PayWall_bi2",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"bi2",isNotSale:!0,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1}:{id:"PayWall_bi",goldDiamondCount:this.Price,pType:this.ptye.subscriber,cms:this.cms.subscriber,value:"bi",isNotSale:!0,issubscription:!0,isSinglebuy:!1,isWhiteDiamond:!1,isAddvalue:!1,isfreeread:!1};var n={Token:await ArticleIndex.getCookie("BWG_CC"),JData:{SourceId:this.layout.cms}};fetch("/Archive/API/TitleUrl",{method:"POST",body:JSON.stringify(n),headers:{"Content-Type":"application/json; charset=utf-8"}}).then(n=>n.json()).then(async n=>{n.errorCode==0&&(this.titleurl=n.jData)})}});let c=document.getElementById("ArticleIndexUpdateMember"),n=document.getElementById("PayWall_bi"),t=document.getElementById("PayWall_bi2"),i=document.getElementById("PayWall_b1"),r=document.getElementById("PayWall_b12"),u=document.getElementById("PayWall_b4"),f=document.getElementById("PayWall_b42"),e=document.getElementById("PayWall_b3"),o=document.getElementById("PayWall_b32"),s=document.getElementById("PayWall_b2"),h=document.getElementById("PayWall_b22");if(c){const l=function(n,t){if(n[0].isIntersecting)try{let i=n[0].target.id;switch(i){case"PayWall_bi":Track("paywall","impression","bi",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_bi2":Track("paywall","impression","bi2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b1":Track("paywall","impression","b1",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b12":Track("paywall","impression","b12",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b4":Track("paywall","impression","b4",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b42":Track("paywall","impression","b42",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b3":Track("paywall","impression","b3",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b32":Track("paywall","impression","b32",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b2":Track("paywall","impression","b2",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null);break;case"PayWall_b22":Track("paywall","impression","b22",GetAtypeCode()+"-"+GetUrlParameter("StrId"),null)}t.unobserve(n[0].target)}catch(i){throw i;}},c=new IntersectionObserver(l,{root:null,rootMargin:"0px 0px 0px 0px",threshold:0});n&&setTimeout(()=>{c.observe(n)},200);t&&setTimeout(()=>{c.observe(t)},200);i&&setTimeout(()=>{c.observe(i)},200);r&&setTimeout(()=>{c.observe(r)},200);u&&setTimeout(()=>{c.observe(u)},200);f&&setTimeout(()=>{c.observe(f)},200);e&&setTimeout(()=>{c.observe(e)},200);o&&setTimeout(()=>{c.observe(o)},200);s&&setTimeout(()=>{c.observe(s)},200);h&&setTimeout(()=>{c.observe(h)},200)}}